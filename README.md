
# Overview

This repository contains and data and scripts for reproducing the results accompanying the manuscript  

### Clonal heterogeneity and antigenic stimulation shape persistence of the latent reservoir of HIV
Marco Garcia Noceda<sup>1</sup>, Gargi Kher<sup>2</sup>, Shikhar Uttam<sup>2,3</sup> and John P. Barton<sup>1,2,4,#</sup>

<sup>1</sup> Department of Physics and Astronomy, University of California, Riverside, USA
<sup>2</sup> Department of Computational and Systems Biology, University of Pittsburgh School of Medicine, USA
<sup>3</sup> UPMC Hillman Cancer Center, USA
<sup>4</sup> Department of Physics and Astronomy, University of Pittsburgh, USA
<sup>#</sup> correspondence to [jpbarton@pitt.edu](mailto:jpbarton@pitt.edu)  

The preprint is available at __INSERT LINK HERE__.

# Contents

Scripts for generating the distinct simulations can be found in `src`. These scripts can be compiled with speicfic flags (listed below) that determine which simulation will be run: full simulation of the model, simulation with early intervention due to early ART or elite controllers, simulation with analytical treatment interruption, or simulations with constant reactivation probabilities and/or antigenic simulation.

The `figures.ipynb` contains a template Jupyter notebook for reproducing the figures accompanying the paper. It makes use of the libraries `figures.py` and `mplot.py`.

Due to the large size of the output files generated by the simulations, data has been stored in a compressed format using Zenodo. To access the full set of data, navigate to the [Zenodo record](https://zenodo.org/record/7898811). Download and extract the contents of `data.zip` as the folder `/data`.

### Software dependencies

Simulations make use of C++11 and OpenMP to run in parallel.

### Compilation examples

To compile and run on linux:

`g++ -DFULL simulation.cpp io.cpp -O2 -std=c++23 -o simulation_FULL.exe`

`./simulation_FULL.exe`

If any other simulation needs to be run, just replace the `-DFULL` flag with one of the following options:

`-DEARLY` (early ART simulation)

`-DFULL_ATI` (full ART simulation with Analytical Treatment Interruption)

`-DEARLY_ATI` (early ART simulation with Analytical Treatment Interruption)

`-DCONST_PR` (full ART simulation under a constant reactivation probability)

`-DCONST_AG` (full ART simulation under constant antigenic stimulation)

`-DCONST_PR_AG` (full ART simulation under constant reactivation probability and antigenic stimulation)

### Other notes
Make sure to check the config.sh file to ensure that output files are being sent to the correct folders. These scripts are configured to be run as an array job but if not running an array job, uncomment line 209 in simulation.cpp and adjust the output files in config.sh as needed.


# License

This repository is dual licensed as [GPL-3.0](LICENSE-GPL) (source code) and [CC0 1.0](LICENSE-CC0) (figures, documentation, and our presentation of the data).
